# Implement Worktree Snapshots for ai_edit

## Objective
Automatically create a worktree diff before each `ai_edit` execution and generate a diff showing only changes made during the current operation relative to the previous diff.

## Acceptance Criteria
- Automatically create a worktree diff before each `ai_edit` execution
- Generate diff showing only changes made during the current operation relative to the previous diff

## Files to Modify
- mcp_devtools/mcp_devtools_cli.py (if needed for the tool)
- The implementation likely needs changes to the `ai_edit` tool handler

## Additional Context
This is User Story 1 from TODO.md. We need to implement this without disrupting existing functionality.

## Answers to Clarifying Questions
1. Use timestamped files for snapshots (e.g., `.mcp-devtools/ai_edit_20240909T032146_pre.diff`)
2. Represent binary files with placeholder: `[Binary file omitted from diff]`

# Add unit tests for worktree snapshots feature

## Objective
Add comprehensive unit tests for the worktree snapshots feature implemented in User Story 1.

## Acceptance Criteria
- Test that pre-execution and post-execution snapshots are created
- Test that the delta diff correctly shows only changes made during the current operation
- Test handling of binary files in snapshots
- Test that pre-existing untracked files are excluded from the delta
- Ensure tests cover both success and error scenarios

## Files to Modify
- test_server.py

## Additional Context
We've implemented the snapshot feature in server.py. Now we need tests to ensure its correctness and prevent regressions.
